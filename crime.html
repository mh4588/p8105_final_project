<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Crime in NYC Parks</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<html>
<head>
<script>
  // Dynamically set the favicon based on the page URL
  const url = window.location.pathname; // Get the current page's URL path
  let faviconPath = "images/favicon.png"; // Default favicon

  // Set favicon based on specific keywords in the URL
  if (url.includes("restroom")) {
    faviconPath = "images/restroom_icon.png";
  } else if (url.includes("cleanliness")) {
    faviconPath = "images/cleanliness_icon.jpg";
  } else if (url.includes("crime")) {
    faviconPath = "images/crime_icon.png";
  } else if (url.includes("syringe")) {
    faviconPath = "images/needle.png";
  }

  // Dynamically create and append the favicon link
  const link = document.createElement("link");
  link.rel = "shortcut icon";
  link.href = faviconPath;
  document.head.appendChild(link);
</script>
</head>
</html>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="report.html">Report</a>
    </li>
    <li>
      <a href="about_team.html">About the Team</a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="crime.html">Crime</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sanitation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="cleanliness.html">Overall Cleanliness</a>
    </li>
    <li>
      <a href="restroom.html">Restroom</a>
    </li>
    <li>
      <a href="syringe.html">Syringe</a>
    </li>
  </ul>
</li>
<li>
  <a href="maps.html">Facility Maps</a>
</li>
<li>
  <a href="https://github.com/mh4588/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Crime in NYC Parks</h1>

</div>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Exploring park crimes in NYC is essential for several reasons:</p>
<ul>
<li><p>Improving Public Safety: Identifying high-risk areas allows for
targeted interventions, ensuring the protection of parkgoers.</p></li>
<li><p>Raising Community Awareness: Understanding crime patterns guides
public education and prevention efforts to reduce risks in
parks.</p></li>
<li><p>Addressing Social and Economic Impact: Crime in parks can deter
park usage, affecting local businesses and community engagement, which
crime analysis can help mitigate.</p></li>
<li><p>Targeting Specific Times or Groups: Seasonal and demographic
crime patterns allow for targeted safety measures tailored to specific
risks.</p></li>
</ul>
<div style="text-align: center;">
<p><img src="images/NYPD.jpg" /> Image source: <a
href="https://commons.wikimedia.org/wiki/File:NYPD_3_wheeled_car_in_Central_Park.JPG">NYPD
in Central Park</a></p>
</div>
</div>
<div id="dataset" class="section level2">
<h2>Dataset</h2>
<p>For this part, we chose <a
href="https://www.nyc.gov/site/nypd/stats/crime-statistics/park-crime-stats.page">NYC
Park Crime Statistics</a> provided by NYPD. This dataset contains
detailed records of reported crimes in New York City’s parks. It
includes data on various crime types, such as robbery, assault, and
larceny, categorized by park, borough, and time period. This dataset is
updated quarterly and aims to enhance public safety by offering
transparency on crime trends in recreational areas. It serves as a
valuable resource for researchers, policymakers, and residents
interested in understanding and addressing crime in NYC parks.</p>
<p>The data processing process involves several steps to import, clean,
and filter crime data from various park crime files spanning from 2015
to 2024. Since crime data is stored quarterly, we wrote a function to
traverse all data file paths and special files were handled
individually. The final dataset includes variables:</p>
<ul>
<li><code>park</code>: park names;<br />
</li>
<li><code>borough</code>: parks’ boroughs;<br />
</li>
<li><code>size_acres</code>: size in acres;<br />
</li>
<li><code>category</code>: categories of parks;<br />
</li>
<li>Crime types: <code>murder</code>, <code>rape</code>,
<code>robbery</code>, <code>felony_assault</code>,
<code>burglary</code>, <code>grand_larceny</code>,
<code>grand_larceny_of_motor_vehicles</code>;<br />
</li>
<li><code>total</code>: total crimes happened in that park;<br />
</li>
<li><code>year</code>: statistical year;<br />
</li>
<li><code>season</code>: statistical season.</li>
</ul>
<p>Each row is a crime record for a park in specific year and
season.</p>
<pre class="r"><code># Define a function to import and clean a single file with exceptions
import_park_crime_data = function(year, season) {
  # Skip 2024 Q4
  if (year == 2024 &amp;&amp; season == &quot;q4&quot;) {
    return(NULL)
  }
  
  # Determine the file path
  file_path = sprintf(&quot;data/nycparks_crime/%d/nyc-park-crime-stats-%s-%d.xlsx&quot;, year, season, year)
  
  # Use skip = 4 for specific files, otherwise skip = 3
  skip_rows = ifelse((year == 2015 &amp;&amp; season %in% c(&quot;q1&quot;, &quot;q2&quot;, &quot;q3&quot;)) || (year == 2018 &amp;&amp; season == &quot;q2&quot;), 4, 3)
  
  # Attempt to read the file
  data = tryCatch(
    {
      read_excel(file_path, skip = skip_rows) |&gt;
        janitor::clean_names()
    },
    error = function(e) {
      warning(sprintf(&quot;Failed to read file: %s. Error: %s&quot;, file_path, e$message))
      return(NULL) # Skip problematic files
    }
  )
  
  # Check if the &#39;park&#39; column exists, and proceed accordingly
  if (!&quot;park&quot; %in% names(data)) {
    warning(sprintf(&quot;Column &#39;park&#39; not found in file: %s&quot;, file_path))
    return(NULL) # Return NULL for this file if &#39;park&#39; is missing
  }
  
    # List of columns to ensure numeric
  numeric_columns = c(
    &quot;size_acres&quot;, &quot;murder&quot;, &quot;rape&quot;, &quot;robbery&quot;, &quot;felony_assault&quot;, 
    &quot;burglary&quot;, &quot;grand_larceny&quot;, &quot;grand_larceny_of_motor_vehicle&quot;, &quot;total&quot;
  )
  
  # Add missing numeric columns as NA
  missing_columns = setdiff(numeric_columns, names(data))
  if (length(missing_columns) &gt; 0) {
    data[missing_columns] = NA
  }
  
  # Ensure these columns are numeric
  data = data |&gt;
    mutate(across(all_of(numeric_columns), as.numeric))
  
  # Perform cleaning and filtering
  data |&gt;
    mutate(
      park = str_replace_all(str_to_lower(park), &quot; &quot;, &quot;_&quot;),
      borough = str_replace_all(str_to_lower(borough), &quot; &quot;, &quot;_&quot;),
      category = str_replace_all(str_to_lower(category), &quot; &quot;, &quot;_&quot;),
      year = year,
      season = season
    ) |&gt;
    filter(total &gt; 0)
}

# Generate a data frame with all combinations of years and seasons
years = 2015:2024
seasons = c(&quot;q1&quot;, &quot;q2&quot;, &quot;q3&quot;, &quot;q4&quot;)
year_season_combinations = expand.grid(year = years, season = seasons)

# Import and combine all the data
all_park_crime_data = year_season_combinations |&gt;
  pmap_dfr(~ import_park_crime_data(..1, ..2))

all_park_crime_data = all_park_crime_data |&gt;
  filter(
    park != &quot;total&quot;
  )</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory Data Analysis</h2>
<div id="crime-counts-by-year-in-nyc-parks" class="section level3">
<h3>Crime Counts by Year in NYC Parks</h3>
<pre class="r"><code># Prepare data for plotting
crime_data_long = all_park_crime_data |&gt;
  select(year, murder, rape, robbery, felony_assault, burglary, grand_larceny, grand_larceny_of_motor_vehicle) |&gt;
  pivot_longer(
    cols = c(murder, rape, robbery, felony_assault, burglary, grand_larceny, grand_larceny_of_motor_vehicle),
    names_to = &quot;crime_type&quot;,
    values_to = &quot;count&quot;
  ) |&gt;
  group_by(year, crime_type) |&gt;
  summarize(total_count = sum(count, na.rm = TRUE), .groups = &quot;drop&quot;)

crime_data_long$year = as.factor(crime_data_long$year)

# Plot the data
p1 = ggplot(crime_data_long, aes(x = year, y = total_count, color = crime_type, group = crime_type)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = &quot;Crime Counts by Year in NYC Parks&quot;,
    x = &quot;Year&quot;,
    y = &quot;Total Count&quot;,
    color = &quot;Crime Type&quot;
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = &quot;top&quot;, # Move the legend to the top
    legend.title = element_text(size = 12, face = &quot;bold&quot;), # Style the legend title
    legend.text = element_text(size = 10), # Style the legend text
    legend.margin = margin(t = 5, b = 5), # Adjust spacing around the legend
    legend.key.width = unit(1, &quot;cm&quot;) # Adjust the key width for better readability
  )

p1</code></pre>
<p><img src="crime_files/figure-html/unnamed-chunk-2-1.png" width="768" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(&quot;images/report/crime_1.png&quot;, p1, width = 8, height = 6, dpi = 300)</code></pre>
<p>It can be judged from the plot that serious crimes like grand larceny
of motor vehicle, murder, rape and robbery, have a relative stable
account and trend. However, crimes like burglary, felony assault and
grand larceny (not motor vehicle but maybe jewelry or other valuables),
have some fluctuations. Burglary and robbery has some decrease in 2020,
largely because COVID-19 exploded and travel restriction was conducted.
However, felony assault may show a potential increase due to factors
such as sparse crowds or a limited number of offenders, which create an
environment conducive to the crime. Psychologically, the perpetrators
may feel emboldened, believing that the lack of witnesses reduces the
likelihood of being arrested.</p>
</div>
<div id="crime-proportion" class="section level3">
<h3>Crime Proportion</h3>
<pre class="r"><code>library(plotly)

crime_types = all_park_crime_data |&gt;
  select(murder, rape, robbery, felony_assault, burglary, grand_larceny, grand_larceny_of_motor_vehicle) |&gt;
  summarize(across(everything(), sum, na.rm = TRUE)) |&gt;
  pivot_longer(cols = everything(), names_to = &quot;crime_type&quot;, values_to = &quot;total_crimes&quot;)

# Create a pie chart
p2 = plot_ly(
  data = crime_types,
  labels = ~crime_type,
  values = ~total_crimes,
  type = &#39;pie&#39;,
  textinfo = &#39;label+percent&#39;,
  insidetextorientation = &#39;radial&#39;
) |&gt;
  layout(
    title = &quot;Proportion of Different Crime Types (2015–2024)&quot;,
    showlegend = TRUE
  )

p2</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-7ba56184d7bc3d080afa" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-7ba56184d7bc3d080afa">{"x":{"visdat":{"11bec432f6666":["function () ","plotlyVisDat"]},"cur_data":"11bec432f6666","attrs":{"11bec432f6666":{"labels":{},"values":{},"textinfo":"label+percent","insidetextorientation":"radial","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Proportion of Different Crime Types (2015–2024)","showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["murder","rape","robbery","felony_assault","burglary","grand_larceny","grand_larceny_of_motor_vehicle"],"values":[72,200,3322,2363,279,4401,83],"textinfo":"label+percent","insidetextorientation":"radial","type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the pie chart, we can figure out that grand larceny (41.1%),
robbery (31%) and felony assault (22%) were main crime types during last
ten years.</p>
<p>The observed crime patterns in parks suggest that property-related
offenses, particularly Grand Larceny and Robbery, are the most frequent,
likely due to the ease of committing such crimes in less monitored
areas, such as parks, where large-scale or repeat offenses can occur.
Physical crimes like Felony Assault, while present, are less common,
possibly due to lower reporting rates or a focus by law enforcement on
non-violent offenses in park settings. Violent crimes like Murder and
Rape are rare in parks, reflecting their overall low frequency but
higher severity, likely influenced by deterrent measures, stronger
enforcement, or the generally lower prevalence of such crimes in public
spaces. The low incidence of Grand Larceny of Motor Vehicles in parks
might indicate the effectiveness of targeted law enforcement efforts or
security measures, such as surveillance, to deter such offenses.</p>
</div>
<div id="heatmap-of-crime-counts" class="section level3">
<h3>Heatmap of Crime Counts</h3>
<pre class="r"><code>crime_heatmap = all_park_crime_data |&gt;
  group_by(year, borough) |&gt;
  mutate(
    year = as.factor(year)
  ) |&gt;
  filter(
    park != &quot;total&quot;
  )|&gt;
  summarize(total_crimes = sum(total, na.rm = TRUE))


p3 = ggplot(crime_heatmap, aes(x = year, y = reorder(borough, total_crimes, sum), fill = total_crimes)) +
  geom_tile(color = &quot;white&quot;) +
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;red&quot;) +
  labs(
    title = &quot;Heatmap of Crimes by Year and Borough&quot;,
    x = &quot;Year&quot;,
    y = &quot;Borough&quot;,
    fill = &quot;Total Crimes&quot;
  ) +
  theme_minimal()

p3</code></pre>
<p><img src="crime_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(&quot;images/report/crime_3.png&quot;, p3, width = 8, height = 6, dpi = 300)</code></pre>
<p>This is a heatmap of total crimes happened in different boroughs by
year. In this heatmap, the higher the number of crimes, the darker the
red color. It’s pretty obvious that Manhattan has a high crime rate.
However, analyzing by years, there is no obvious changing trend.</p>
<p>The observed crime patterns across NYC boroughs reveal several
underlying factors. Manhattan and Brooklyn, being densely populated and
economically active, experience higher crime rates, with Manhattan’s
concentration of businesses, tourist attractions, and nightlife further
amplifying incidents. Socioeconomic challenges in the Bronx may
contribute to its moderate crime levels, while Queens’ residential
nature and diversity correlate with comparatively lower rates. Staten
Island’s minimal crime totals could reflect its suburban character and
potential differences in law enforcement focus or reporting practices.
Over time, crime levels across boroughs remain relatively stable, with
slight variations possibly influenced by shifts in policies,
enforcement, or socio-economic dynamics.</p>
</div>
<div id="crime-statistics-by-borough" class="section level3">
<h3>Crime Statistics by Borough</h3>
<pre class="r"><code># Pivot data to a longer format for plotting
crime_by_borough = all_park_crime_data |&gt;
    replace_na(list(
    murder = 0,
    rape = 0,
    robbery = 0,
    felony_assault = 0,
    burglary = 0,
    grand_larceny = 0,
    grand_larceny_of_motor_vehicle = 0
  )) |&gt;
  pivot_longer(
    cols = c(murder, rape, robbery, felony_assault, burglary, grand_larceny, grand_larceny_of_motor_vehicle),
    names_to = &quot;crime_type&quot;,
    values_to = &quot;crime_count&quot;
  ) |&gt;
  filter(
    borough != &quot;NA&quot;
  ) |&gt;
  group_by(
    crime_type, borough
  ) |&gt;
  summarise(
    crime_count = sum(crime_count)
  ) |&gt;
  ungroup() |&gt;
  mutate(
    borough = fct_reorder(borough, crime_count, .fun = sum, na.rm = TRUE)
  )


# Plot with facet_wrap
ggplot(crime_by_borough, aes(x = borough, y = crime_count, fill = borough)) +
  geom_col(show.legend = TRUE) +
  facet_wrap(~crime_type, scales = &quot;free_y&quot;) +
  labs(
    title = &quot;Crime Counts by Type and Borough&quot;,
    x = &quot;Borough&quot;,
    y = &quot;Crime Count&quot;
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_blank(),
    strip.text = element_text(face = &quot;bold&quot;, size = 10)
  )</code></pre>
<p><img src="crime_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>This plot compares crime counts by type and borough in New York City,
with each panel representing a specific crime type. Manhattan stands out
with the highest crime counts for grand larceny and felony assault,
while Brooklyn leads in grand larceny of motor vehicle. The Bronx shows
notably high counts for robbery and murder, often surpassing other
boroughs for these crimes. In contrast, Staten Island and the
Brooklyn/Queens area consistently report the lowest crime counts across
all categories. Property crimes like grand larceny and felony assault
have significantly higher totals compared to violent crimes such as
murder and rape, which show smaller totals.</p>
<p>The differences in crime counts across boroughs and crime types may
stem from several factors. Manhattan, with its dense population and
economic activity, shows higher grand larceny and felony assault rates
due to more opportunities for theft and interpersonal conflicts. The
Bronx, often associated with economic challenges, exhibits higher rates
of violent crimes like murder and robbery. Brooklyn’s urban sprawl and
higher car ownership contribute to more grand larceny of motor vehicles.
Staten Island’s low crime counts may reflect its smaller population or
underreporting. Variations in tourism, socioeconomic conditions,
policing, and community infrastructure further influence the
distribution of crimes.</p>
</div>
<div id="distribution-of-crime-counts-by-type-in-top-3-parks"
class="section level3">
<h3>Distribution of Crime Counts by Type in Top 3 Parks</h3>
<pre class="r"><code># Calculate the total crimes per park
crime_data_summary = all_park_crime_data |&gt; 
  group_by(park) |&gt;
  filter(
    park != &quot;total&quot;
  ) |&gt;
  summarize(total_crimes = sum(total, na.rm = TRUE)) |&gt; 
  arrange(desc(total_crimes))


# Get the top 3 parks with the most crimes
top_parks = crime_data_summary |&gt; head(3) |&gt; pull(park)

# Filter the original data to include only the top 3 parks
crime_data_top_parks = all_park_crime_data |&gt; 
  filter(park %in% top_parks) |&gt;
  pivot_longer(
    cols = murder:grand_larceny_of_motor_vehicle,
    names_to = &quot;crime_type&quot;,
    values_to = &quot;total_count&quot;
  )

knitr::kable(crime_data_summary |&gt;
               head())</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">park</th>
<th align="right">total_crimes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">flushing_meadows_corona_park</td>
<td align="right">775</td>
</tr>
<tr class="even">
<td align="left">washington_square_park</td>
<td align="right">511</td>
</tr>
<tr class="odd">
<td align="left">coney_island_beach_&amp;_boardwalk</td>
<td align="right">418</td>
</tr>
<tr class="even">
<td align="left">randall’s_island_park</td>
<td align="right">369</td>
</tr>
<tr class="odd">
<td align="left">prospect_park</td>
<td align="right">307</td>
</tr>
<tr class="even">
<td align="left">bryant_park</td>
<td align="right">252</td>
</tr>
</tbody>
</table>
<p>Above is the top six parks where most crimes occurred. We want to
have a look at these parks’ crime distribution by type for assisting you
to determine whether this is truly a dangerous park or if it simply has
incidents of relatively minor crimes. Thus, we selected the three parks
with the highest total number of crimes, and then divided them into
statistics and visualizations according to the types of crimes. The
following is the statistical table and the chart.</p>
<pre class="r"><code>top_3_crime_park = crime_data_top_parks |&gt;
  group_by(
    park, crime_type
  ) |&gt;
  summarise(
    count = sum(total_count)
  ) |&gt;
  pivot_wider(
    names_from = crime_type,
    values_from = count
  ) |&gt;
  replace_na(
    list(murder = 0)
  )

top3_crime_table = top_3_crime_park |&gt;
  kbl(
    col.names = c(
      &quot;Park Name&quot;, 
      rep(c(&quot;Burglary&quot;, &quot;Felony Assault&quot;, &quot;Grand Larceny&quot;, 
            &quot;Motor Vehicle Theft&quot;, &quot;Murder&quot;, &quot;Rape&quot;, &quot;Robbery&quot;), 1)
    ),
    caption = &quot;Crime Statistics by Park&quot;
  ) |&gt;
  add_header_above(c(&quot; &quot; = 1, &quot;Crimes&quot; = 7)) |&gt;
  kable_styling(
    full_width = FALSE, 
    bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;),
    position = &quot;center&quot;,
    font_size = 14
  ) |&gt;
  column_spec(1, width = &quot;25em&quot;) |&gt; 
  column_spec(2:8, extra_css = &quot;padding-right: 20px; padding-left: 20px;&quot;) |&gt;
  row_spec(0, bold = TRUE, extra_css = &quot;padding-bottom: 10px;&quot;) |&gt; # Add spacing to header row
  kable_styling(latex_options = &quot;hold_position&quot;) |&gt; 
  row_spec(1:3, extra_css = &quot;padding-top: 10px; padding-bottom: 10px;&quot;)

top3_crime_table</code></pre>
<table class="table table-striped table-hover table-condensed table" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Crime Statistics by Park
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="7">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Crimes
</div>
</th>
</tr>
<tr>
<th style="text-align:left;font-weight: bold;padding-bottom: 10px;">
Park Name
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Burglary
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Felony Assault
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Grand Larceny
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Motor Vehicle Theft
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Murder
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Rape
</th>
<th style="text-align:right;font-weight: bold;padding-bottom: 10px;">
Robbery
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 25em; padding-top: 10px; padding-bottom: 10px;">
coney_island_beach_&amp;_boardwalk
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
4
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
78
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
245
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
1
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
0
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
6
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
81
</td>
</tr>
<tr>
<td style="text-align:left;width: 25em; padding-top: 10px; padding-bottom: 10px;">
flushing_meadows_corona_park
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
42
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
124
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
436
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
48
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
0
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
9
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
116
</td>
</tr>
<tr>
<td style="text-align:left;width: 25em; padding-top: 10px; padding-bottom: 10px;">
washington_square_park
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
1
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
118
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
325
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
0
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
0
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
2
</td>
<td style="text-align:right;padding-right: 20px; padding-left: 20px;padding-top: 10px; padding-bottom: 10px;">
64
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Prepare the data for plotting
top_3_crime_park_long = top_3_crime_park |&gt;
  pivot_longer(
    cols = -park, # All columns except &quot;park&quot;
    names_to = &quot;crime_type&quot;,
    values_to = &quot;count&quot;
  ) |&gt;
  filter(
    crime_type != &quot;murder&quot;
  )

# Plot using ggplot2
p4 = ggplot(top_3_crime_park_long, aes(x = park, y = count, fill = park)) +
  geom_bar(stat = &quot;identity&quot;, alpha = 0.8, show.legend = TRUE) +
  facet_wrap(~ crime_type, scales = &quot;free_y&quot;, ncol = 3) + # Facet by crime type
  theme_minimal() +
  theme(
    text = element_text(size = 12),
    axis.text.x = element_blank(), # Rotate x-axis labels for readability
    axis.text.y = element_text(size = 10),
    plot.title = element_text(size = 16, hjust = 0.5, face = &quot;bold&quot;), # Center and bold title
    strip.text = element_text(size = 8, face = &quot;bold&quot;), # Style facet titles
    panel.spacing = unit(2, &quot;lines&quot;),
    legend.key.size = unit(0.4, &quot;cm&quot;), # Reduce legend key size
    legend.text = element_text(size = 10), # Adjust legend text size
    legend.title = element_text(size = 11, face = &quot;bold&quot;), # Adjust legend title
    legend.position = &quot;top&quot; # Place legend at the top
  ) +
  labs(
    title = &quot;Crime Distribution by Type Across Top Parks&quot;,
    x = &quot;Park&quot;,
    y = &quot;Crime Count&quot;
  )

p4</code></pre>
<p><img src="crime_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(&quot;images/report/crime_4.png&quot;, p4, width = 8, height = 6, dpi = 300)</code></pre>
<p>From both the table and the plot, there were no murders in any of the
three parks, and felonies were relatively rare. It is reasonable to
assume that the high number of crimes in these parks is due to the high
number of less serious crimes.</p>
<p>The plot highlights crime distribution across three NYC parks: Coney
Island Beach &amp; Boardwalk, Flushing Meadows-Corona Park, and
Washington Square Park. Grand larceny is the most frequent crime,
particularly in Flushing Meadows-Corona Park and Washington Square Park,
likely due to high foot traffic and the presence of valuables. Robbery
and felony assault are also significant, especially in Flushing
Meadows-Corona Park, which may result from its size and varied spaces
that create opportunities for such offenses. Burglary rates are minimal,
concentrated primarily in Flushing Meadows-Corona Park, likely due to
the limited number of vulnerable structures. Grand larceny of motor
vehicles is notable only in Flushing Meadows-Corona Park, possibly
reflecting its extensive parking areas. Violent crimes like rape are
rare, with no mention of murder, aligning with broader trends of low
violent crime rates in public spaces due to deterrent measures and
enforcement. These patterns reflect park-specific factors such as size,
usage, accessibility, and monitoring.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p><strong>1.Data Quality and Completeness.</strong></p>
<p>The dataset relies on reported crimes, which may underrepresent
actual crime occurrences due to underreporting, especially in parks
located in boroughs with lower socioeconomic conditions.</p>
<p><strong>2.Lack of Predictive Analysis.</strong></p>
<p>Insights into causation or actionable triggers for crime remain
limited, restricting the utility of findings for proactive measures.</p>
<p><strong>3.Visualization Limitations.</strong></p>
<p>Although the visualizations are informative, some charts, such as the
heatmap, might oversimplify trends by aggregating data at the borough
level. This approach could mask intra-borough variations or
park-specific patterns.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
